"use strict";(self["webpackChunkvue3_2022_spring"]=self["webpackChunkvue3_2022_spring"]||[]).push([[601],{4722:function(t,a,e){e.d(a,{Z:function(){return b}});var l=e(6252);const o={class:"modal fade",id:"DangerModal","data-bs-keyboard":"false"},i={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},d={class:"modal-content"},s={class:"modal-body p-3"},n={class:"mb-2"},r=(0,l._)("div",{class:"d-flex align-items-center justify-content-end mt-2"},[(0,l._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"}," 我知道了 ")],-1);function c(t,a){return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",i,[(0,l._)("div",d,[(0,l._)("div",s,[(0,l._)("h2",n,[(0,l.WI)(t.$slots,"title")]),(0,l._)("p",null,[(0,l.WI)(t.$slots,"default")]),r])])])])}var m=e(3744);const p={},u=(0,m.Z)(p,[["render",c]]);var b=u},7601:function(t,a,e){e.r(a),e.d(a,{default:function(){return $t}});var l=e(6252),o=e(3577);const i={class:"d-flex align-items-center justify-content-between"},d=(0,l._)("h1",{class:"mb-0"},"產品列表",-1),s={class:"table-responsive py-2"},n={class:"table text-center align-middle"},r=(0,l._)("thead",{class:"table-light"},[(0,l._)("tr",null,[(0,l._)("th",{width:"8%",scope:"col"},"#"),(0,l._)("th",{width:"8%",scope:"col"},"分類"),(0,l._)("th",{class:"text-start",scope:"col"},"產品名稱"),(0,l._)("th",{width:"10%",scope:"col"},"原價"),(0,l._)("th",{width:"10%",scope:"col"},"售價"),(0,l._)("th",{width:"10%",scope:"col"},"是否啟用"),(0,l._)("th",{width:"20%",scope:"col"},"編輯")])],-1),c={class:"text-center"},m={class:"text-start"},p={class:"form-check form-switch float-none d-inline-block mb-0"},u=["onClick"],b=["onClick"],h=["onClick"],g={key:0},_=(0,l._)("td",{class:"text-center",colspan:"7"}," 目前尚無資料 ",-1),f=[_],y=(0,l.Uk)(" 是否刪除 "),v={class:"text-danger"},w=(0,l._)("br",null,null,-1),k=(0,l.Uk)(" 提醒您，刪除後將無法恢復 ");function U(t,a,e,_,U,M){const x=(0,l.up)("pagination-nav"),D=(0,l.up)("ProductModal"),$=(0,l.up)("SuccessModal"),C=(0,l.up)("DangerModal"),P=(0,l.up)("DeleteModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",i,[d,(0,l._)("button",{class:"btn btn-sm btn-primary",type:"button",onClick:a[0]||(a[0]=a=>{U.modal.title="新增產品",M.openProductModal(U.modal.title,t.product)})}," 建立新的產品 ")]),(0,l._)("div",s,[(0,l._)("table",n,[r,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(U.products,((t,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,o.zw)(a+1),1),(0,l._)("td",c,(0,o.zw)(t.category),1),(0,l._)("td",m,(0,o.zw)(t.title),1),(0,l._)("td",null,(0,o.zw)(t.origin_price.toLocaleString()),1),(0,l._)("td",null,(0,o.zw)(t.price.toLocaleString()),1),(0,l._)("td",null,[(0,l._)("div",p,[(0,l._)("button",{class:(0,o.C_)(["form-check-input",{checked:1==t.is_enabled}]),onClick:a=>{M.toggleEnabled(t)}},null,10,u)])]),(0,l._)("td",null,[(0,l._)("button",{class:"btn btn-sm btn-primary me-1",type:"button",onClick:a=>{U.modal.title="編輯產品",M.openProductModal(U.modal.title,t)}}," 編輯 ",8,b),(0,l._)("button",{class:"btn btn-sm btn-outline-danger",type:"button",onClick:a=>{U.modal.title="刪除商品",M.openProductModal(U.modal.title,t)}}," 刪除 ",8,h)])])))),128)),0===U.products?.length?((0,l.wg)(),(0,l.iD)("tr",g,f)):(0,l.kq)("",!0)])])]),(0,l.Wm)(x,{pages:U.paginations,onGetDatas:M.getProduct},null,8,["pages","onGetDatas"]),(0,l.Wm)(D,{modal:U.modal.temp,type:U.modal.title,onEmitUpdateData:M.updateProduct},{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(U.modal.title),1)])),_:1},8,["modal","type","onEmitUpdateData"]),(0,l.Wm)($,null,{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(U.modal.title),1)])),default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(U.modal.content),1)])),_:1}),(0,l.Wm)(C,{modal:U.modal.temp},{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(U.modal.title),1)])),default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(U.modal.content),1)])),_:1},8,["modal"]),(0,l.Wm)(P,{modal:U.modal.temp,onEmitDeleteData:M.deleteProduct},{title:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(U.modal.title),1)])),default:(0,l.w5)((()=>[y,(0,l._)("b",v,(0,o.zw)(U.modal.temp.title),1),w,k])),_:1},8,["modal","onEmitDeleteData"])],64)}var M=e(4983),x=e(9963);const D={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},$={class:"modal-content"},C={class:"modal-body p-3"},P={class:"mb-2"},S={class:"row"},I={class:"col-md-8"},z={class:"row"},V={class:"col-md-5"},j={class:"form-floating mb-2"},E=(0,l._)("label",{for:"floatingTitle"},"請輸入標題",-1),F={class:"form-floating mb-2"},W=(0,l._)("label",{for:"floatingCategory"},"請輸入分類",-1),Z={class:"form-floating mb-2"},O=(0,l._)("label",{for:"floatingUnit"},"請輸入單位",-1),J={class:"form-floating mb-2"},L=(0,l._)("label",{for:"floatingOrigin"},"請輸入原價",-1),N={class:"form-floating mb-2"},H=(0,l._)("label",{for:"floatingSelling"},"請輸入售價",-1),Y={class:"col-md-7"},q={class:"row mx-auto"},G=(0,l._)("label",{for:"floatingMainPic"},"請輸入主圖網址或上傳圖片",-1),K={class:"col-md-4 py-1 pe-0 mb-2 position-relative"},T=(0,l._)("button",{class:"d-block w-100 h-100 btn btn-sm btn-light",type:"button"}," 上傳圖片 ",-1),A=(0,l._)("label",{for:"mainFile",class:"position-absolute"},null,-1),B=["src"],Q={class:"col-md-12"},R={class:"form-floating mb-2"},X=(0,l._)("label",{for:"floatingDescription"},"請輸入產品描述",-1),tt={class:"form-floating mb-2"},at=(0,l._)("label",{for:"floatingContent"},"請輸入說明內容",-1),et={class:"form-check mb-2"},lt=(0,l._)("label",{class:"form-check-label",for:"checkEnable"}," 是否啟用 ",-1),ot={class:"col-md-4"},it=(0,l._)("h3",{class:"mb-2"},"多圖新增",-1),dt={class:"row"},st={class:"row mx-auto"},nt=["id","onUpdate:modelValue"],rt=["for"],ct={class:"col-md-4 py-1 pe-0 mb-2 position-relative"},mt=(0,l._)("button",{class:"d-block w-100 h-100 btn btn-sm btn-light",type:"button"}," 上傳圖片 ",-1),pt=(0,l._)("label",{for:"subFile",class:"position-absolute"},null,-1),ut=["data-index"],bt=["src"],ht={class:"d-flex align-items-center justify-content-end mt-2"},gt=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary me-1","data-bs-dismiss":"modal"}," 取消 ",-1);function _t(t,a,e,i,d,s){return(0,l.wg)(),(0,l.iD)("form",{class:"modal fade needs-validation",id:"productModal","data-bs-backdrop":"static","data-bs-keyboard":"false",novalidate:"",onSubmit:a[14]||(a[14]=(0,x.iM)((()=>{}),["prevent"]))},[(0,l._)("div",D,[(0,l._)("div",$,[(0,l._)("div",C,[(0,l._)("h2",P,[(0,l.WI)(t.$slots,"title")]),(0,l._)("div",S,[(0,l._)("div",I,[(0,l._)("div",z,[(0,l._)("div",V,[(0,l._)("div",j,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control border-0 border-bottom border-secondary",id:"floatingTitle",placeholder:"請輸入標題","onUpdate:modelValue":a[0]||(a[0]=t=>d.data.title=t)},null,512),[[x.nr,d.data.title]]),E]),(0,l._)("div",F,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control border-0 border-bottom border-secondary",id:"floatingCategory",placeholder:"請輸入分類","onUpdate:modelValue":a[1]||(a[1]=t=>d.data.category=t)},null,512),[[x.nr,d.data.category]]),W]),(0,l._)("div",Z,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control border-0 border-bottom border-secondary",id:"floatingUnit",placeholder:"請輸入單位","onUpdate:modelValue":a[2]||(a[2]=t=>d.data.unit=t)},null,512),[[x.nr,d.data.unit]]),O]),(0,l._)("div",J,[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control border-0 border-bottom border-secondary",id:"floatingOrigin",placeholder:"請輸入原價","onUpdate:modelValue":a[3]||(a[3]=t=>d.data.origin_price=t)},null,512),[[x.nr,d.data.origin_price]]),L]),(0,l._)("div",N,[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control border-0 border-bottom border-secondary",id:"floatingSelling",placeholder:"請輸入售價","onUpdate:modelValue":a[4]||(a[4]=t=>d.data.price=t)},null,512),[[x.nr,d.data.price]]),H])]),(0,l._)("div",Y,[(0,l._)("div",q,[(0,l._)("div",{class:(0,o.C_)(["col-md-8 px-0 form-floating mb-2",{"col-md-12":d.data.imageUrl}])},[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control border-0 border-bottom border-secondary",id:"floatingMainPic","onUpdate:modelValue":a[5]||(a[5]=t=>d.data.imageUrl=t),placeholder:"請輸入主圖網址或上傳圖片"},null,512),[[x.nr,d.data.imageUrl]]),G],2),(0,l.wy)((0,l._)("div",K,[T,A,(0,l._)("input",{type:"file",class:"d-block w-100 h-100 position-absolute top-0 start-0 opacity-0",id:"mainFile",placeholder:"上傳圖片","data-type":"main",onChange:a[6]||(a[6]=(...t)=>s.uploadImage&&s.uploadImage(...t))},null,32)],512),[[x.F8,!d.data.imageUrl]])]),d.data.imageUrl?((0,l.wg)(),(0,l.iD)("img",{key:0,class:"img-fluid",src:d.data.imageUrl,alt:""},null,8,B)):(0,l.kq)("",!0)]),(0,l._)("div",Q,[(0,l._)("div",R,[(0,l.wy)((0,l._)("textarea",{class:"form-control border-0 border-bottom border-secondary",placeholder:"Leave a comment here",id:"floatingDescription",style:{height:"100px"},"onUpdate:modelValue":a[7]||(a[7]=t=>d.data.description=t)},null,512),[[x.nr,d.data.description]]),X]),(0,l._)("div",tt,[(0,l.wy)((0,l._)("textarea",{class:"form-control border-0 border-bottom border-secondary",placeholder:"Leave a comment here",id:"floatingContent",style:{height:"100px"},"onUpdate:modelValue":a[8]||(a[8]=t=>d.data.content=t)},null,512),[[x.nr,d.data.content]]),at]),(0,l._)("div",et,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",value:"is_enabled",id:"checkEnable","onUpdate:modelValue":a[9]||(a[9]=t=>d.data.is_enabled=t),"true-value":1,"false-value":0},null,512),[[x.e8,d.data.is_enabled,void 0,{number:!0}]]),lt])])])]),(0,l._)("div",ot,[it,(0,l._)("div",dt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.data.imagesUrl,((t,e)=>((0,l.wg)(),(0,l.iD)("div",{class:"col-12 mb-2",key:e},[(0,l._)("div",st,[(0,l._)("div",{class:(0,o.C_)(["col-md-8 px-0 form-floating mb-2",{"col-md-12":t}])},[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control border-0 border-bottom border-secondary",id:"floatingPic"+e,"onUpdate:modelValue":t=>d.data.imagesUrl[e]=t,placeholder:"請輸入網址或上傳圖片"},null,8,nt),[[x.nr,d.data.imagesUrl[e]]]),(0,l._)("label",{for:"floatingPic"+e},"請輸入網址或上傳圖片",8,rt)],2),(0,l.wy)((0,l._)("div",ct,[mt,pt,(0,l._)("input",{type:"file",class:"d-block w-100 h-100 position-absolute top-0 start-0 opacity-0",id:"subFile",placeholder:"上傳圖片","data-index":e,"data-type":"sub",onChange:a[10]||(a[10]=(...t)=>s.uploadImage&&s.uploadImage(...t))},null,40,ut)],512),[[x.F8,!t]])]),(0,l.wy)((0,l._)("img",{class:"img-fluid",src:t,alt:""},null,8,bt),[[x.F8,t]])])))),128))]),!d.data.imagesUrl?.length||d.data.imagesUrl[d.data.imagesUrl.length-1]?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"d-block w-100 btn btn-sm btn-primary mb-2",type:"button",onClick:a[11]||(a[11]=(...t)=>s.addImage&&s.addImage(...t))}," 新增圖片 ")):((0,l.wg)(),(0,l.iD)("button",{key:1,class:"d-block w-100 btn btn-sm btn-outline-danger mb-2",type:"button",onClick:a[12]||(a[12]=(...t)=>s.removeImage&&s.removeImage(...t))}," 刪除圖片 "))])]),(0,l._)("div",ht,[gt,(0,l._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:a[13]||(a[13]=a=>t.$emit("emit-update-data",d.title,d.data))}," 確認 ")])])])])],32)}var ft={data(){return{data:{},title:null,return:{title:null,content:null}}},props:["modal","type"],emits:["emit-update-data"],methods:{uploadImage(t){const a=new FormData;a.append("file-to-upload",t.target.files[0]),this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/upload",a).then((a=>{"main"===t.target.dataset.type?this.data.imageUrl=a.data.imageUrl:"sub"===t.target.dataset.type&&(this.data.imagesUrl[t.target.dataset.index]=a.data.imageUrl)})).catch((t=>{console.dir(t)}))},addImage(){void 0===this.data.imagesUrl&&(this.data.imagesUrl=[]),this.data.imagesUrl.push("")},removeImage(){this.data.imagesUrl.pop()}},watch:{modal(){this.data=this.modal,this.title=this.type}}},yt=e(3744);const vt=(0,yt.Z)(ft,[["render",_t]]);var wt=vt,kt=e(5146),Ut=e(4722),Mt=e(7393),xt={data(){return{page:1,products:[],paginations:{},bsModal:null,modal:{title:"",content:"",temp:{}}}},emits:["page-loading"],components:{ProductModal:wt,SuccessModal:kt.Z,DangerModal:Ut.Z,DeleteModal:Mt.Z},mounted(){this.getProduct()},methods:{getProduct(t=1){const a=`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/products?page=${t}`;this.$emitter.emit("page-loading",!0),this.$http.get(a).then((t=>{this.paginations=t.data.pagination,this.products=t.data.products,this.$emitter.emit("page-loading",!1)})).catch((t=>{console.dir(t),alert(t.response.data.message)}))},updateProduct(t,a){this.$emitter.emit("page-loading",!0);const e={data:a};let l=null,o=null;"新增產品"===t?(l="https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product",o="post"):"編輯產品"===t&&(l=`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product/${this.modal.temp.id}`,o="put"),this.$http[o](l,e).then((a=>{"新增產品"===t?this.modal.title="新增成功":"編輯產品"===t&&(this.modal.title="修改成功"),this.modal.content=a.data.message,this.modal.temp={}})).catch((a=>{console.dir(a),"新增產品"===t?this.modal.title="新增失敗":"編輯產品"===t&&(this.modal.title="修改失敗"),this.modal.content=a.response.data.message})).finally((()=>{this.getProduct(),this.openSuccessModal()}))},deleteProduct(t){const a=`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product/${t.id}`;this.$emitter.emit("page-loading",!0),this.$http.delete(a).then((t=>{this.modal.title="刪除成功",this.modal.content=t.data.message,this.getProduct()})).catch((t=>{console.dir(t),this.modal.title="刪除失敗",this.modal.content=t.response.data.message})).finally((()=>{this.openSuccessModal(this.modal.title,this.modal.content)}))},toggleEnabled(t){const a=`https://vue3-course-api.hexschool.io/v2/api/ujhwang/admin/product/${t.id}`;this.$emitter.emit("page-loading",!0),this.modal.temp=t;const e={data:this.modal.temp};0===this.modal.temp.is_enabled||void 0===this.modal.temp.is_enabled?this.modal.temp.is_enabled=1:1===this.modal.temp.is_enabled&&(this.modal.temp.is_enabled=0),this.$http.put(a,e).then((t=>{this.modal.title="修改成功",this.modal.content=t.data.message,this.getProduct()})).catch((t=>{console.dir(t),this.modal.title="修改失敗",this.modal.content=t.response.data.message})).finally((()=>{this.openSuccessModal(this.modal.title,this.modal.content)}))},openProductModal(t,a){this.$emitter.emit("page-loading",!1),"編輯產品"===t?(this.bsModal=(0,M.$7)("productModal"),this.modal.temp=JSON.parse(JSON.stringify(a))):"新增產品"===t?(this.bsModal=(0,M.$7)("productModal"),this.modal.temp={}):"刪除商品"===t&&(this.bsModal=(0,M.$7)("deleteModal"),this.modal.temp=JSON.parse(JSON.stringify(a))),this.bsModal.show()},openSuccessModal(){this.$emitter.emit("page-loading",!1),this.bsModal=(0,M.$7)("SuccessModal"),this.bsModal.show()},openDangerModal(t){this.$emitter.emit("page-loading",!1),this.modal.title=t.title,this.modal.content=t.content,this.bsModal=(0,M.$7)("DangerModal"),this.bsModal.show()}}};const Dt=(0,yt.Z)(xt,[["render",U]]);var $t=Dt}}]);
//# sourceMappingURL=601.ccb66e64.js.map